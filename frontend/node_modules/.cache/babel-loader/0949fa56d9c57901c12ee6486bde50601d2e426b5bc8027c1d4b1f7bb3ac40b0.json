{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-742896af\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"login-container\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h1\", null, \"Login\", -1));\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"login-email\"\n}, \"Email:\", -1));\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"login-password\"\n}, \"Password:\", -1));\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\"\n}, \"Login\", -1));\nconst _hoisted_6 = {\n  key: 0,\n  class: \"error-message\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"form\", {\n    onSubmit: _cache[2] || (_cache[2] = _withModifiers((...args) => $options.login && $options.login(...args), [\"prevent\"]))\n  }, [_createElementVNode(\"div\", null, [_hoisted_3, _withDirectives(_createElementVNode(\"input\", {\n    id: \"login-email\",\n    type: \"email\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.email = $event),\n    required: \"\",\n    title: \"Entrez votre mail\",\n    placeholder: \"example@mail.com\"\n  }, null, 512), [[_vModelText, $data.email]])]), _createElementVNode(\"div\", null, [_hoisted_4, _withDirectives(_createElementVNode(\"input\", {\n    id: \"login-password\",\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.password = $event),\n    required: \"\",\n    title: \"Entrez votre Mot de Passe\",\n    placeholder: \"Your password\"\n  }, null, 512), [[_vModelText, $data.password]])]), _hoisted_5], 32), $data.errorMessage ? (_openBlock(), _createElementBlock(\"p\", _hoisted_6, _toDisplayString($data.errorMessage), 1)) : _createCommentVNode(\"\", true), _createElementVNode(\"p\", null, [_createTextVNode(\" Don't have an account? \"), _createVNode(_component_router_link, {\n    to: \"/register\"\n  }, {\n    default: _withCtx(() => [_createTextVNode(\"Register here\")]),\n    _: 1\n  })])]);\n}","map":{"version":3,"names":["class","_createElementVNode","for","type","key","_createElementBlock","_hoisted_1","_hoisted_2","onSubmit","_cache","_withModifiers","args","$options","login","_hoisted_3","id","$event","$data","email","required","title","placeholder","_hoisted_4","password","_hoisted_5","errorMessage","_hoisted_6","_toDisplayString","_createCommentVNode","_createTextVNode","_createVNode","_component_router_link","to","default","_withCtx","_"],"sources":["/home/zana/pewfect-1/frontend/src/views/loginPage.vue"],"sourcesContent":["<!--\n\t./frontend/src/views/loginPage.vue\n-->\n\n <template>\n\t<div class=\"login-container\">\n\t\t<h1>Login</h1>\n\t\t<!-- Formulaire de connexion -->\n\t\t<form @submit.prevent=\"login\">\n\t\t\t<div>\n\t\t\t\t<!-- Champ email -->\n\t\t\t\t<label for=\"login-email\">Email:</label>\n\t\t\t\t<input\n\t\t\t\t\tid=\"login-email\"\n\t\t\t\t\ttype=\"email\"\n\t\t\t\t\tv-model=\"email\"\n\t\t\t\t\trequired\n\t\t\t\t\ttitle=\"Entrez votre mail\"\n\t\t\t\t\tplaceholder=\"example@mail.com\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<!-- Champ mot de passe -->\n\t\t\t\t<label for=\"login-password\">Password:</label>\n\t\t\t\t<input\n\t\t\t\t\tid=\"login-password\"\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t\tv-model=\"password\"\n\t\t\t\t\trequired\n\t\t\t\t\ttitle=\"Entrez votre Mot de Passe\"\n\t\t\t\t\tplaceholder=\"Your password\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<!-- Bouton de connexion -->\n\t\t\t<button type=\"submit\">Login</button>\n\t\t</form>\n\t\t<!-- Message d'erreur affiché en cas de problème de connexion -->\n\t\t<p v-if=\"errorMessage\" class=\"error-message\">{{ errorMessage }}</p>\n\t\t<p>\n\t\t\t<!-- Lien vers la page d'inscription -->\n\t\t\tDon't have an account?\n\t\t\t<router-link to=\"/register\">Register here</router-link>\n\t\t</p>\n\t</div>\n</template>\n\n<script>\nimport axios from 'axios';\n\nexport default {\n\tname: 'LoginPage',\n\tdata() {\n\t\treturn {\n\t\t\temail: '',\n\t\t\tpassword: '',\n\t\t\terrorMessage: '',\n\t\t};\n\t},\n\n\tmethods: {\n\t\tasync login() {\n\t\t\ttry {\n\t\t\t\tconst response = await axios.post(\n\t\t\t\t\t'http://localhost:3000/api/users/login',\n\t\t\t\t\t{\n\t\t\t\t\t\temail: this.email,\n\t\t\t\t\t\tpassword: this.password,\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tconst { userId, token, role } = response.data;\n\n\t\t\t\t// Créer un objet utilisateur à partir de userId\n\t\t\t\tconst user = {\n\t\t\t\t\tid: userId,\n\t\t\t\t\temail: this.email,\n\t\t\t\t\trole: role,\n\t\t\t\t};\n\n\t\t\t\t// Ajout d'un log pour vérifier le nouvel objet utilisateur\n\t\t\t\tconsole.log('User created:', user);\n\n\t\t\t\t// Mettre à jour le localStorage\n\t\t\t\tlocalStorage.setItem('user', JSON.stringify(user));\n\t\t\t\tlocalStorage.setItem('token', token);\n\t\t\t\tlocalStorage.setItem('role', role);\n\n\t\t\t\t// Ajout d'un log pour vérifier le stockage\n\t\t\t\tconsole.log(\n\t\t\t\t\t'User stored in localStorage:',\n\t\t\t\t\tlocalStorage.getItem('user')\n\t\t\t\t);\n\n\t\t\t\t// Mettre à jour le store Vuex\n\t\t\t\tthis.$store.dispatch('login', { user, token, role });\n\n\t\t\t\t// Redirige l'utilisateur en fonction de son rôle\n\t\t\t\tif (role === 'admin' || role === 'responsable') {\n\t\t\t\t\tthis.$router.push({ name: 'Admin' });\n\t\t\t\t} else if (role === 'client') {\n\t\t\t\t\tthis.$router.push({ name: 'Accueil' });\n\t\t\t\t} else {\n\t\t\t\t\tthis.$router.push('/');\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tif (!error.response) {\n\t\t\t\t\tthis.errorMessage =\n\t\t\t\t\t\t'Une erreur est survenue, veuillez réessayer ultérieurement.';\n\t\t\t\t} else if (error.response.status === 400) {\n\t\t\t\t\tthis.errorMessage = error.response.data.error;\n\t\t\t\t} else {\n\t\t\t\t\tthis.errorMessage =\n\t\t\t\t\t\t'Une erreur est survenue, veuillez réessayer ultérieurement.';\n\t\t\t\t}\n\t\t\t\tconsole.error('Login failed:', error);\n\t\t\t}\n\t\t},\n\t},\n};\n</script>\n\n<style scoped>\n/* Styles pour le conteneur de connexion */\n.login-container {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\theight: 100vh;\n}\n\n/* Styles pour le message d'erreur */\n.error-message {\n\tcolor: red;\n\tmargin-top: 10px;\n}\n</style>\n"],"mappings":";;;EAKMA,KAAK,EAAC;AAAiB;gEAC3BC,mBAAA,CAAc,YAAV,OAAK;gEAKPA,mBAAA,CAAuC;EAAhCC,GAAG,EAAC;AAAa,GAAC,QAAM;gEAY/BD,mBAAA,CAA6C;EAAtCC,GAAG,EAAC;AAAgB,GAAC,WAAS;gEAWtCD,mBAAA,CAAoC;EAA5BE,IAAI,EAAC;AAAQ,GAAC,OAAK;;EAlC9BC,GAAA;EAqCyBJ,KAAK,EAAC;;;;uBAhC9BK,mBAAA,CAsCM,OAtCNC,UAsCM,GArCLC,UAAc,EAEdN,mBAAA,CA2BO;IA3BAO,QAAM,EAAAC,MAAA,QAAAA,MAAA,MARfC,cAAA,KAAAC,IAAA,KAQyBC,QAAA,CAAAC,KAAA,IAAAD,QAAA,CAAAC,KAAA,IAAAF,IAAA,CAAK;MAC3BV,mBAAA,CAWM,cATLa,UAAuC,E,gBACvCb,mBAAA,CAOE;IANDc,EAAE,EAAC,aAAa;IAChBZ,IAAI,EAAC,OAAO;IAdjB,uBAAAM,MAAA,QAAAA,MAAA,MAAAO,MAAA,IAecC,KAAA,CAAAC,KAAK,GAAAF,MAAA;IACdG,QAAQ,EAAR,EAAQ;IACRC,KAAK,EAAC,mBAAmB;IACzBC,WAAW,EAAC;gCAHHJ,KAAA,CAAAC,KAAK,E,KAMhBjB,mBAAA,CAWM,cATLqB,UAA6C,E,gBAC7CrB,mBAAA,CAOE;IANDc,EAAE,EAAC,gBAAgB;IACnBZ,IAAI,EAAC,UAAU;IA1BpB,uBAAAM,MAAA,QAAAA,MAAA,MAAAO,MAAA,IA2BcC,KAAA,CAAAM,QAAQ,GAAAP,MAAA;IACjBG,QAAQ,EAAR,EAAQ;IACRC,KAAK,EAAC,2BAA2B;IACjCC,WAAW,EAAC;gCAHHJ,KAAA,CAAAM,QAAQ,E,KAOnBC,UAAoC,C,OAG5BP,KAAA,CAAAQ,YAAY,I,cAArBpB,mBAAA,CAAmE,KAAnEqB,UAAmE,EAAAC,gBAAA,CAAnBV,KAAA,CAAAQ,YAAY,SArC9DG,mBAAA,YAsCE3B,mBAAA,CAII,YA1CN4B,gBAAA,CAsCK,0BAGF,GAAAC,YAAA,CAAuDC,sBAAA;IAA1CC,EAAE,EAAC;EAAW;IAzC9BC,OAAA,EAAAC,QAAA,CAyC+B,MAAa,CAzC5CL,gBAAA,CAyC+B,eAAa,E;IAzC5CM,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}