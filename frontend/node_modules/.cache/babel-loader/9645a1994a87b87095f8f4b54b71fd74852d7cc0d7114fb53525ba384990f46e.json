{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-2400e800\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"admin-container\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h1\", null, \"Admin Page\", -1));\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_researchBar = _resolveComponent(\"researchBar\");\n  const _component_UserTable = _resolveComponent(\"UserTable\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createVNode(_component_researchBar, {\n    modelValue: $data.searchQuery,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.searchQuery = $event),\n    placeholder: \"Search for a user...\"\n  }, null, 8, [\"modelValue\"]), _createVNode(_component_UserTable, {\n    title: \"Admins\",\n    users: $options.filteredUsers('admin'),\n    role: \"admin\",\n    userRole: $data.userRole,\n    onChangeRole: $options.changeUserRole,\n    onDeleteUser: $options.deleteUser\n  }, null, 8, [\"users\", \"userRole\", \"onChangeRole\", \"onDeleteUser\"]), _createVNode(_component_UserTable, {\n    title: \"Responsables\",\n    users: $options.filteredUsers('responsable'),\n    role: \"responsable\",\n    userRole: $data.userRole,\n    onChangeRole: $options.changeUserRole,\n    onDeleteUser: $options.deleteUser\n  }, null, 8, [\"users\", \"userRole\", \"onChangeRole\", \"onDeleteUser\"]), _createVNode(_component_UserTable, {\n    title: \"Clients\",\n    users: $options.filteredUsers('client'),\n    role: \"client\",\n    userRole: $data.userRole,\n    onChangeRole: $options.changeUserRole,\n    onDeleteUser: $options.deleteUser\n  }, null, 8, [\"users\", \"userRole\", \"onChangeRole\", \"onDeleteUser\"])]);\n}","map":{"version":3,"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_createVNode","_component_researchBar","modelValue","$data","searchQuery","_cache","$event","placeholder","_component_UserTable","title","users","$options","filteredUsers","role","userRole","onChangeRole","changeUserRole","onDeleteUser","deleteUser"],"sources":["/home/zana/pewfect-1/frontend/src/views/adminPage.vue"],"sourcesContent":["<!--\n\t./frontend/src/views/adminPage.vue\n-->\n\n<template>\n\t<div class=\"admin-container\">\n\t\t<h1>Admin Page</h1>\n\n\t\t<!-- Bar de Recherche -->\n\t\t<researchBar v-model=\"searchQuery\" placeholder=\"Search for a user...\" />\n\n\t\t<!-- Table des utilisateurs avec le rôle \"admin\" -->\n\t\t<UserTable\n\t\t\ttitle=\"Admins\"\n\t\t\t:users=\"filteredUsers('admin')\"\n\t\t\trole=\"admin\"\n\t\t\t:userRole=\"userRole\"\n\t\t\t@change-role=\"changeUserRole\"\n\t\t\t@delete-user=\"deleteUser\"\n\t\t/>\n\t\t<!-- Table des utilisateurs avec le rôle \"responsable\" -->\n\t\t<UserTable\n\t\t\ttitle=\"Responsables\"\n\t\t\t:users=\"filteredUsers('responsable')\"\n\t\t\trole=\"responsable\"\n\t\t\t:userRole=\"userRole\"\n\t\t\t@change-role=\"changeUserRole\"\n\t\t\t@delete-user=\"deleteUser\"\n\t\t/>\n\t\t<!-- Table des utilisateurs avec le rôle \"client\" -->\n\t\t<UserTable\n\t\t\ttitle=\"Clients\"\n\t\t\t:users=\"filteredUsers('client')\"\n\t\t\trole=\"client\"\n\t\t\t:userRole=\"userRole\"\n\t\t\t@change-role=\"changeUserRole\"\n\t\t\t@delete-user=\"deleteUser\"\n\t\t/>\n\t</div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport UserTable from '../components/userTable.vue';\nimport researchBar from '../components/researchBar.vue';\n\nexport default {\n\tname: 'AdminPage',\n\tcomponents: {\n\t\tUserTable,\n\t\tresearchBar,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tusers: [], // Liste des utilisateurs\n\t\t\tuserRole: '', // Rôle de l'utilisateur connecté\n\t\t\tsearchQuery: '', // Requête de recherche\n\t\t};\n\t},\n\t// Récupère les utilisateurs et initialise le rôle\n\tasync mounted() {\n\t\tawait this.refreshUsers();\n\t\tthis.userRole = localStorage.getItem('role');\n\t},\n\tcomputed: {\n\t\t// Filtre les utilisateurs par rôle\n\t\tfilteredUsers() {\n\t\t\treturn role => {\n\t\t\t\treturn this.filterUsers(this.filterUsersByRole(role));\n\t\t\t};\n\t\t},\n\t},\n\n\tmethods: {\n\t\t// Méthode pour changer le rôle d'un utilisateur\n\t\tasync changeUserRole(userId, newRole) {\n\t\t\ttry {\n\t\t\t\tawait axios.put(`http://localhost:3000/api/users/${userId}/role`, {\n\t\t\t\t\trole: newRole,\n\t\t\t\t});\n\t\t\t\talert(`Utilisateur mis à jour avec succès vers ${newRole}`);\n\t\t\t\tthis.refreshUsers();\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\n\t\t\t\t\t`Erreur lors de la mise à jour de l'utilisateur :`,\n\t\t\t\t\terror\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\n\t\t// Méthode pour supprimer un utilisateur\n\t\tasync deleteUser(userId) {\n\t\t\ttry {\n\t\t\t\tawait axios.delete(`http://localhost:3000/api/users/${userId}`);\n\t\t\t\talert('Utilisateur supprimé avec succès');\n\t\t\t\tthis.refreshUsers();\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\n\t\t\t\t\t\"Erreur lors de la suppression de l'utilisateur :\",\n\t\t\t\t\terror\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\n\t\t// Méthode pour récupérer et initialiser les utilisateurs\n\t\tasync refreshUsers() {\n\t\t\ttry {\n\t\t\t\tconst response = await axios.get('http://localhost:3000/api/users');\n\t\t\t\tthis.users = response.data;\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\n\t\t\t\t\t'Erreur lors de la récupération des utilisateurs :',\n\t\t\t\t\terror\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\n\t\t// Méthode pour filtrer les utilisateurs par rôle\n\t\tfilterUsersByRole(role) {\n\t\t\treturn this.users.filter(\n\t\t\t\tuser =>\n\t\t\t\t\tuser.Register &&\n\t\t\t\t\tuser.Register.Role &&\n\t\t\t\t\tuser.Register.Role.role === role\n\t\t\t);\n\t\t},\n\n\t\t// Méthode pour filtrer les utilisateurs par requête de recherche\n\t\tfilterUsers(users) {\n\t\t\treturn users.filter(user => {\n\t\t\t\tconst fullName =\n\t\t\t\t\t`${user.last_name} ${user.first_name} ${user.email} ${user.phone}`.toLowerCase();\n\t\t\t\treturn fullName.includes(this.searchQuery.toLowerCase());\n\t\t\t});\n\t\t},\n\t},\n};\n</script>\n\n<style scoped>\n/* Styles pour le conteneur admin */\n.admin-container {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 20px;\n}\n</style>\n"],"mappings":";;;EAKMA,KAAK,EAAC;AAAiB;gEAC3BC,mBAAA,CAAmB,YAAf,YAAU;;;;uBADfC,mBAAA,CAiCM,OAjCNC,UAiCM,GAhCLC,UAAmB,EAGnBC,YAAA,CAAwEC,sBAAA;IAT1EC,UAAA,EASwBC,KAAA,CAAAC,WAAW;IATnC,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IASwBH,KAAA,CAAAC,WAAW,GAAAE,MAAA;IAAEC,WAAW,EAAC;+BAG/CP,YAAA,CAOEQ,oBAAA;IANDC,KAAK,EAAC,QAAQ;IACbC,KAAK,EAAEC,QAAA,CAAAC,aAAa;IACrBC,IAAI,EAAC,OAAO;IACXC,QAAQ,EAAEX,KAAA,CAAAW,QAAQ;IAClBC,YAAW,EAAEJ,QAAA,CAAAK,cAAc;IAC3BC,YAAW,EAAEN,QAAA,CAAAO;sEAGflB,YAAA,CAOEQ,oBAAA;IANDC,KAAK,EAAC,cAAc;IACnBC,KAAK,EAAEC,QAAA,CAAAC,aAAa;IACrBC,IAAI,EAAC,aAAa;IACjBC,QAAQ,EAAEX,KAAA,CAAAW,QAAQ;IAClBC,YAAW,EAAEJ,QAAA,CAAAK,cAAc;IAC3BC,YAAW,EAAEN,QAAA,CAAAO;sEAGflB,YAAA,CAOEQ,oBAAA;IANDC,KAAK,EAAC,SAAS;IACdC,KAAK,EAAEC,QAAA,CAAAC,aAAa;IACrBC,IAAI,EAAC,QAAQ;IACZC,QAAQ,EAAEX,KAAA,CAAAW,QAAQ;IAClBC,YAAW,EAAEJ,QAAA,CAAAK,cAAc;IAC3BC,YAAW,EAAEN,QAAA,CAAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}