{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-18896fa8\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"register-container\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h1\", null, \"Register\", -1));\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"register-email\"\n}, \"Email:\", -1));\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"register-password\"\n}, \"Password:\", -1));\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"register-confirmPassword\"\n}, \"Confirm Password:\", -1));\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\"\n}, \"Register\", -1));\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"form\", {\n    onSubmit: _cache[3] || (_cache[3] = _withModifiers((...args) => $options.register && $options.register(...args), [\"prevent\"]))\n  }, [_createElementVNode(\"div\", null, [_hoisted_3, _withDirectives(_createElementVNode(\"input\", {\n    id: \"register-email\",\n    type: \"email\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.email = $event),\n    required: \"\",\n    title: \"Entrez votre mail\",\n    placeholder: \"example@mail.com\"\n  }, null, 512), [[_vModelText, $data.email]])]), _createElementVNode(\"div\", null, [_hoisted_4, _withDirectives(_createElementVNode(\"input\", {\n    id: \"register-password\",\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.password = $event),\n    required: \"\",\n    title: \"Entrez votre mot de passe\",\n    placeholder: \"Your password\"\n  }, null, 512), [[_vModelText, $data.password]])]), _createElementVNode(\"div\", null, [_hoisted_5, _withDirectives(_createElementVNode(\"input\", {\n    id: \"register-confirmPassword\",\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.confirmPassword = $event),\n    required: \"\",\n    title: \"Répéter votre mot de passe\",\n    placeholder: \"Repeat password\"\n  }, null, 512), [[_vModelText, $data.confirmPassword]])]), _hoisted_6], 32)]);\n}","map":{"version":3,"names":["class","_createElementVNode","for","type","_createElementBlock","_hoisted_1","_hoisted_2","onSubmit","_cache","_withModifiers","args","$options","register","_hoisted_3","id","$event","$data","email","required","title","placeholder","_hoisted_4","password","_hoisted_5","confirmPassword","_hoisted_6"],"sources":["/home/zana/pewfect-1/frontend/src/views/registerPage.vue"],"sourcesContent":["<!--\n\t./frontend/src/views/registerPage.vue\n-->\n\n <template>\n\t<!-- Formulaire d'inscription -->\n\t<div class=\"register-container\">\n\t\t<h1>Register</h1>\n\t\t<form @submit.prevent=\"register\">\n\t\t\t<div>\n\t\t\t\t<!-- Champ email -->\n\t\t\t\t<label for=\"register-email\">Email:</label>\n\t\t\t\t<input\n\t\t\t\t\tid=\"register-email\"\n\t\t\t\t\ttype=\"email\"\n\t\t\t\t\tv-model=\"email\"\n\t\t\t\t\trequired\n\t\t\t\t\ttitle=\"Entrez votre mail\"\n\t\t\t\t\tplaceholder=\"example@mail.com\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<!-- Champ mot de passe -->\n\t\t\t\t<label for=\"register-password\">Password:</label>\n\t\t\t\t<input\n\t\t\t\t\tid=\"register-password\"\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t\tv-model=\"password\"\n\t\t\t\t\trequired\n\t\t\t\t\ttitle=\"Entrez votre mot de passe\"\n\t\t\t\t\tplaceholder=\"Your password\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<!-- Champ confirmation du mot de passe -->\n\t\t\t\t<label for=\"register-confirmPassword\">Confirm Password:</label>\n\t\t\t\t<input\n\t\t\t\t\tid=\"register-confirmPassword\"\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t\tv-model=\"confirmPassword\"\n\t\t\t\t\trequired\n\t\t\t\t\ttitle=\"Répéter votre mot de passe\"\n\t\t\t\t\tplaceholder=\"Repeat password\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<!-- Bouton de d'inscription -->\n\t\t\t<button type=\"submit\">Register</button>\n\t\t</form>\n\t</div>\n</template>\n\n<script>\nimport axios from 'axios';\n\nexport default {\n\tname: 'RegisterPage',\n\tdata() {\n\t\treturn {\n\t\t\t// Stock l'email, password, confirmation\n\t\t\temail: '',\n\t\t\tpassword: '',\n\t\t\tconfirmPassword: '',\n\t\t\terrorMessage: '',\n\t\t};\n\t},\n\n\tmethods: {\n\t\t// Méthode pour gérer l'inscription de l'utilisateur\n\t\tasync register() {\n\t\t\tif (this.password !== this.confirmPassword) {\n\t\t\t\talert('Passwords do not match');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\t// Envoie une requête POST pour enregistrer l'utilisateur\n\t\t\t\tconst response = await axios.post(\n\t\t\t\t\t'http://localhost:3000/api/users/register',\n\t\t\t\t\t{\n\t\t\t\t\t\temail: this.email,\n\t\t\t\t\t\tpassword: this.password,\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tconst { userId, token, role } = response.data;\n\n\t\t\t\t// Créer un object utilisateur\n\t\t\t\tconst user = {\n\t\t\t\t\tid: userId,\n\t\t\t\t\temail: this.email,\n\t\t\t\t\trole: role,\n\t\t\t\t};\n\n\t\t\t\t// Ajoute de log pour vérifié le nouvel objet\n\t\t\t\tconsole.log('User created:', user);\n\n\t\t\t\t// Mettre à jours le localStorage\n\t\t\t\tlocalStorage.setItem('user', JSON.stringify(user));\n\t\t\t\tlocalStorage.setItem('token', token);\n\t\t\t\tlocalStorage.setItem('role', role);\n\n\t\t\t\t// Ajoute d'un log pour vérifié le stockage\n\t\t\t\tconsole.log(\n\t\t\t\t\t'User stored in localStorage',\n\t\t\t\t\tlocalStorage.getItem('user')\n\t\t\t\t);\n\n\t\t\t\t// Mettre à jour le store Vuex\n\t\t\t\tthis.$store.dispatch('login', { user, token, role });\n\n\t\t\t\t// Forcer la réactivité en faisant une nouvelle mutation\n\t\t\t\tthis.$store.commit('setLoginState', { isLoggedIn: true, user });\n\n\t\t\t\t// Ajoute de log pour vérifier l'état du store\n\t\t\t\tconsole.log('State after registration:', this.$store.state);\n\n\t\t\t\t// Si l'inscription est réussie, redirige vers la page \"Client\"\n\t\t\t\tif (response.status === 201) {\n\t\t\t\t\tthis.$router.push({ name: 'Accueil' });\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\t// Gère les erreurs d'inscription\n\t\t\t\tconsole.error('Registration failed:', error);\n\t\t\t\tthis.errorMessage =\n\t\t\t\t\terror.response?.data?.error ||\n\t\t\t\t\t'Une erreur est survenue, veuillez réessayer ultérieurement.';\n\t\t\t\talert(this.errorMessage);\n\t\t\t}\n\t\t},\n\t},\n};\n</script>\n\n<style scoped>\n/* Styles pour le conteneur d'inscription */\n.register-container {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\theight: 100vh;\n}\n</style>\n"],"mappings":";;;EAMMA,KAAK,EAAC;AAAoB;gEAC9BC,mBAAA,CAAiB,YAAb,UAAQ;gEAIVA,mBAAA,CAA0C;EAAnCC,GAAG,EAAC;AAAgB,GAAC,QAAM;gEAYlCD,mBAAA,CAAgD;EAAzCC,GAAG,EAAC;AAAmB,GAAC,WAAS;gEAYxCD,mBAAA,CAA+D;EAAxDC,GAAG,EAAC;AAA0B,GAAC,mBAAiB;gEAWxDD,mBAAA,CAAuC;EAA/BE,IAAI,EAAC;AAAQ,GAAC,UAAQ;;uBAxChCC,mBAAA,CA0CM,OA1CNC,UA0CM,GAzCLC,UAAiB,EACjBL,mBAAA,CAuCO;IAvCAM,QAAM,EAAAC,MAAA,QAAAA,MAAA,MARfC,cAAA,KAAAC,IAAA,KAQyBC,QAAA,CAAAC,QAAA,IAAAD,QAAA,CAAAC,QAAA,IAAAF,IAAA,CAAQ;MAC9BT,mBAAA,CAWM,cATLY,UAA0C,E,gBAC1CZ,mBAAA,CAOE;IANDa,EAAE,EAAC,gBAAgB;IACnBX,IAAI,EAAC,OAAO;IAdjB,uBAAAK,MAAA,QAAAA,MAAA,MAAAO,MAAA,IAecC,KAAA,CAAAC,KAAK,GAAAF,MAAA;IACdG,QAAQ,EAAR,EAAQ;IACRC,KAAK,EAAC,mBAAmB;IACzBC,WAAW,EAAC;gCAHHJ,KAAA,CAAAC,KAAK,E,KAMhBhB,mBAAA,CAWM,cATLoB,UAAgD,E,gBAChDpB,mBAAA,CAOE;IANDa,EAAE,EAAC,mBAAmB;IACtBX,IAAI,EAAC,UAAU;IA1BpB,uBAAAK,MAAA,QAAAA,MAAA,MAAAO,MAAA,IA2BcC,KAAA,CAAAM,QAAQ,GAAAP,MAAA;IACjBG,QAAQ,EAAR,EAAQ;IACRC,KAAK,EAAC,2BAA2B;IACjCC,WAAW,EAAC;gCAHHJ,KAAA,CAAAM,QAAQ,E,KAMnBrB,mBAAA,CAWM,cATLsB,UAA+D,E,gBAC/DtB,mBAAA,CAOE;IANDa,EAAE,EAAC,0BAA0B;IAC7BX,IAAI,EAAC,UAAU;IAtCpB,uBAAAK,MAAA,QAAAA,MAAA,MAAAO,MAAA,IAuCcC,KAAA,CAAAQ,eAAe,GAAAT,MAAA;IACxBG,QAAQ,EAAR,EAAQ;IACRC,KAAK,EAAC,4BAA4B;IAClCC,WAAW,EAAC;gCAHHJ,KAAA,CAAAQ,eAAe,E,KAO1BC,UAAuC,C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}