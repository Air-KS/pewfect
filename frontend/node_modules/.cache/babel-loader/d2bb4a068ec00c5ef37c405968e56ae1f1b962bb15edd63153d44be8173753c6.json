{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nexport default {\n  name: 'RegisterPage',\n  data() {\n    return {\n      // Stock l'email, password, confirmation\n      email: '',\n      password: '',\n      confirmPassword: '',\n      errorMessage: ''\n    };\n  },\n  methods: {\n    // Méthode pour gérer l'inscription de l'utilisateur\n    async register() {\n      if (this.password !== this.confirmPassword) {\n        alert('Passwords do not match');\n        return;\n      }\n      try {\n        // Envoie une requête POST pour enregistrer l'utilisateur\n        const response = await axios.post('http://localhost:3000/api/users/register', {\n          email: this.email,\n          password: this.password\n        });\n        const {\n          userId,\n          token,\n          role\n        } = response.data;\n\n        // Créer un object utilisateur\n        const user = {\n          id: userId,\n          email: this.email,\n          role: role\n        };\n\n        // Ajoute de log pour vérifié le nouvel objet\n        console.log('User created:', user);\n\n        // Mettre à jours le localStorage\n        localStorage.setItem('user', JSON.stringify(user));\n        localStorage.setItem('token', token);\n        localStorage.setItem('role', role);\n\n        // Ajoute d'un log pour vérifié le stockage\n        console.log('User stored in localStorage', localStorage.getItem('user'));\n\n        // Mettre à jour le store Vuex\n        this.$store.dispatch('login', {\n          user,\n          token,\n          role\n        });\n\n        // Forcer la réactivité en faisant une nouvelle mutation\n        this.$store.commit('setLoginState', {\n          isLoggedIn: true,\n          user\n        });\n\n        // Ajoute de log pour vérifier l'état du store\n        console.log('State after registration:', this.$store.state);\n\n        // Si l'inscription est réussie, redirige vers la page \"Client\"\n        if (response.status === 201) {\n          this.$router.push({\n            name: 'Accueil'\n          });\n        }\n      } catch (error) {\n        // Gère les erreurs d'inscription\n        console.error('Registration failed:', error);\n        this.errorMessage = error.response?.data?.error || 'Une erreur est survenue, veuillez réessayer ultérieurement.';\n        alert(this.errorMessage);\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","email","password","confirmPassword","errorMessage","methods","register","alert","response","post","userId","token","role","user","id","console","log","localStorage","setItem","JSON","stringify","getItem","$store","dispatch","commit","isLoggedIn","state","status","$router","push","error"],"sources":["/home/zana/pewfect-1/frontend/src/views/registerPage.vue"],"sourcesContent":["<!--\n\t./frontend/src/views/registerPage.vue\n-->\n\n <template>\n\t<!-- Formulaire d'inscription -->\n\t<div class=\"register-container\">\n\t\t<h1>Register</h1>\n\t\t<form @submit.prevent=\"register\">\n\t\t\t<div>\n\t\t\t\t<!-- Champ email -->\n\t\t\t\t<label for=\"register-email\">Email:</label>\n\t\t\t\t<input\n\t\t\t\t\tid=\"register-email\"\n\t\t\t\t\ttype=\"email\"\n\t\t\t\t\tv-model=\"email\"\n\t\t\t\t\trequired\n\t\t\t\t\ttitle=\"Entrez votre mail\"\n\t\t\t\t\tplaceholder=\"example@mail.com\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<!-- Champ mot de passe -->\n\t\t\t\t<label for=\"register-password\">Password:</label>\n\t\t\t\t<input\n\t\t\t\t\tid=\"register-password\"\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t\tv-model=\"password\"\n\t\t\t\t\trequired\n\t\t\t\t\ttitle=\"Entrez votre mot de passe\"\n\t\t\t\t\tplaceholder=\"Your password\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<!-- Champ confirmation du mot de passe -->\n\t\t\t\t<label for=\"register-confirmPassword\">Confirm Password:</label>\n\t\t\t\t<input\n\t\t\t\t\tid=\"register-confirmPassword\"\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t\tv-model=\"confirmPassword\"\n\t\t\t\t\trequired\n\t\t\t\t\ttitle=\"Répéter votre mot de passe\"\n\t\t\t\t\tplaceholder=\"Repeat password\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<!-- Bouton de d'inscription -->\n\t\t\t<button type=\"submit\">Register</button>\n\t\t</form>\n\t</div>\n</template>\n\n<script>\nimport axios from 'axios';\n\nexport default {\n\tname: 'RegisterPage',\n\tdata() {\n\t\treturn {\n\t\t\t// Stock l'email, password, confirmation\n\t\t\temail: '',\n\t\t\tpassword: '',\n\t\t\tconfirmPassword: '',\n\t\t\terrorMessage: '',\n\t\t};\n\t},\n\n\tmethods: {\n\t\t// Méthode pour gérer l'inscription de l'utilisateur\n\t\tasync register() {\n\t\t\tif (this.password !== this.confirmPassword) {\n\t\t\t\talert('Passwords do not match');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\t// Envoie une requête POST pour enregistrer l'utilisateur\n\t\t\t\tconst response = await axios.post(\n\t\t\t\t\t'http://localhost:3000/api/users/register',\n\t\t\t\t\t{\n\t\t\t\t\t\temail: this.email,\n\t\t\t\t\t\tpassword: this.password,\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tconst { userId, token, role } = response.data;\n\n\t\t\t\t// Créer un object utilisateur\n\t\t\t\tconst user = {\n\t\t\t\t\tid: userId,\n\t\t\t\t\temail: this.email,\n\t\t\t\t\trole: role,\n\t\t\t\t};\n\n\t\t\t\t// Ajoute de log pour vérifié le nouvel objet\n\t\t\t\tconsole.log('User created:', user);\n\n\t\t\t\t// Mettre à jours le localStorage\n\t\t\t\tlocalStorage.setItem('user', JSON.stringify(user));\n\t\t\t\tlocalStorage.setItem('token', token);\n\t\t\t\tlocalStorage.setItem('role', role);\n\n\t\t\t\t// Ajoute d'un log pour vérifié le stockage\n\t\t\t\tconsole.log(\n\t\t\t\t\t'User stored in localStorage',\n\t\t\t\t\tlocalStorage.getItem('user')\n\t\t\t\t);\n\n\t\t\t\t// Mettre à jour le store Vuex\n\t\t\t\tthis.$store.dispatch('login', { user, token, role });\n\n\t\t\t\t// Forcer la réactivité en faisant une nouvelle mutation\n\t\t\t\tthis.$store.commit('setLoginState', { isLoggedIn: true, user });\n\n\t\t\t\t// Ajoute de log pour vérifier l'état du store\n\t\t\t\tconsole.log('State after registration:', this.$store.state);\n\n\t\t\t\t// Si l'inscription est réussie, redirige vers la page \"Client\"\n\t\t\t\tif (response.status === 201) {\n\t\t\t\t\tthis.$router.push({ name: 'Accueil' });\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\t// Gère les erreurs d'inscription\n\t\t\t\tconsole.error('Registration failed:', error);\n\t\t\t\tthis.errorMessage =\n\t\t\t\t\terror.response?.data?.error ||\n\t\t\t\t\t'Une erreur est survenue, veuillez réessayer ultérieurement.';\n\t\t\t\talert(this.errorMessage);\n\t\t\t}\n\t\t},\n\t},\n};\n</script>\n\n<style scoped>\n/* Styles pour le conteneur d'inscription */\n.register-container {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\theight: 100vh;\n}\n</style>\n"],"mappings":";AAoDA,OAAOA,KAAI,MAAO,OAAO;AAEzB,eAAe;EACdC,IAAI,EAAE,cAAc;EACpBC,IAAIA,CAAA,EAAG;IACN,OAAO;MACN;MACAC,KAAK,EAAE,EAAE;MACTC,QAAQ,EAAE,EAAE;MACZC,eAAe,EAAE,EAAE;MACnBC,YAAY,EAAE;IACf,CAAC;EACF,CAAC;EAEDC,OAAO,EAAE;IACR;IACA,MAAMC,QAAQA,CAAA,EAAG;MAChB,IAAI,IAAI,CAACJ,QAAO,KAAM,IAAI,CAACC,eAAe,EAAE;QAC3CI,KAAK,CAAC,wBAAwB,CAAC;QAC/B;MACD;MAEA,IAAI;QACH;QACA,MAAMC,QAAO,GAAI,MAAMV,KAAK,CAACW,IAAI,CAChC,0CAA0C,EAC1C;UACCR,KAAK,EAAE,IAAI,CAACA,KAAK;UACjBC,QAAQ,EAAE,IAAI,CAACA;QAChB,CACD,CAAC;QAED,MAAM;UAAEQ,MAAM;UAAEC,KAAK;UAAEC;QAAK,IAAIJ,QAAQ,CAACR,IAAI;;QAE7C;QACA,MAAMa,IAAG,GAAI;UACZC,EAAE,EAAEJ,MAAM;UACVT,KAAK,EAAE,IAAI,CAACA,KAAK;UACjBW,IAAI,EAAEA;QACP,CAAC;;QAED;QACAG,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEH,IAAI,CAAC;;QAElC;QACAI,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACP,IAAI,CAAC,CAAC;QAClDI,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEP,KAAK,CAAC;QACpCM,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEN,IAAI,CAAC;;QAElC;QACAG,OAAO,CAACC,GAAG,CACV,6BAA6B,EAC7BC,YAAY,CAACI,OAAO,CAAC,MAAM,CAC5B,CAAC;;QAED;QACA,IAAI,CAACC,MAAM,CAACC,QAAQ,CAAC,OAAO,EAAE;UAAEV,IAAI;UAAEF,KAAK;UAAEC;QAAK,CAAC,CAAC;;QAEpD;QACA,IAAI,CAACU,MAAM,CAACE,MAAM,CAAC,eAAe,EAAE;UAAEC,UAAU,EAAE,IAAI;UAAEZ;QAAK,CAAC,CAAC;;QAE/D;QACAE,OAAO,CAACC,GAAG,CAAC,2BAA2B,EAAE,IAAI,CAACM,MAAM,CAACI,KAAK,CAAC;;QAE3D;QACA,IAAIlB,QAAQ,CAACmB,MAAK,KAAM,GAAG,EAAE;UAC5B,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC;YAAE9B,IAAI,EAAE;UAAU,CAAC,CAAC;QACvC;MACD,EAAE,OAAO+B,KAAK,EAAE;QACf;QACAf,OAAO,CAACe,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;QAC5C,IAAI,CAAC1B,YAAW,GACf0B,KAAK,CAACtB,QAAQ,EAAER,IAAI,EAAE8B,KAAI,IAC1B,6DAA6D;QAC9DvB,KAAK,CAAC,IAAI,CAACH,YAAY,CAAC;MACzB;IACD;EACD;AACD,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}